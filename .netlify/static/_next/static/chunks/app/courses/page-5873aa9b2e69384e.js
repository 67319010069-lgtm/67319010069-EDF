(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[65],{655:function(e,t,s){Promise.resolve().then(s.bind(s,6132))},6132:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return c}});var a=s(3827),r=s(4090),n=s(8792),l=s(4958),i=s(1399);let o=["ทั้งหมด","โปรแกรมมิ่ง","ธุรกิจ","ดิจิทัลมาร์เก็ตติ้ง","ดีไซน์","ภาษา","อื่นๆ"];function c(){let[e,t]=(0,r.useState)([]),[s,c]=(0,r.useState)([]),[u,d]=(0,r.useState)("ทั้งหมด"),[m,p]=(0,r.useState)(""),[x,g]=(0,r.useState)(!0);(0,r.useEffect)(()=>{f()},[]),(0,r.useEffect)(()=>{h()},[u,m,e]);let f=async()=>{let{data:e}=await l.db.getCourses({published:!0}),s=(null==e?void 0:e.map(e=>{var t,s;let a=(null===(t=e.reviews)||void 0===t?void 0:t.length)>0?e.reviews.reduce((e,t)=>e+t.rating,0)/e.reviews.length:0;return{...e,avgRating:a,reviewCount:(null===(s=e.reviews)||void 0===s?void 0:s.length)||0}}))||[];t(s),c(s),g(!1)},h=()=>{let t=e;"ทั้งหมด"!==u&&(t=t.filter(e=>e.category===u)),m&&(t=t.filter(e=>{var t;return e.title.toLowerCase().includes(m.toLowerCase())||(null===(t=e.description)||void 0===t?void 0:t.toLowerCase().includes(m.toLowerCase()))})),c(t)};return(0,a.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-pink-50 via-white to-pink-100 text-gray-900",children:[(0,a.jsx)("nav",{className:"glass sticky top-0 z-50 border-b border-white/20",children:(0,a.jsx)("div",{className:"container mx-auto px-4 py-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)(n.default,{href:"/",className:"flex items-center space-x-2",children:[(0,a.jsx)(i.nGB,{className:"text-3xl text-pink-500"}),(0,a.jsx)("span",{className:"text-2xl font-bold bg-gradient-to-r from-pink-400 to-pink-600 bg-clip-text text-transparent",children:"Eduflow"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)(n.default,{href:"/dashboard",className:"px-4 py-2 text-gray-800 hover:text-pink-600 font-medium",children:"แดชบอร์ด"}),(0,a.jsx)(n.default,{href:"/profile",className:"px-4 py-2 text-gray-800 hover:text-pink-600 font-medium",children:"โปรไฟล์"})]})]})})}),(0,a.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsx)("h1",{className:"text-4xl font-bold mb-4 text-gray-900",children:"คอร์สเรียนทั้งหมด"}),(0,a.jsxs)("div",{className:"relative max-w-2xl",children:[(0,a.jsx)(i.U41,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-500"}),(0,a.jsx)("input",{type:"text",value:m,onChange:e=>p(e.target.value),placeholder:"ค้นหาคอร์สเรียน...",className:"w-full pl-12 pr-4 py-4 glass rounded-xl focus:ring-2 focus:ring-pink-400 focus:outline-none text-gray-900"})]})]}),(0,a.jsx)("div",{className:"flex flex-wrap gap-3 mb-8",children:o.map(e=>(0,a.jsx)("button",{onClick:()=>d(e),className:"px-6 py-2 rounded-full font-medium transition-all ".concat(u===e?"bg-gradient-to-r from-pink-400 to-pink-600 text-white shadow-lg scale-105":"glass text-gray-800 hover:shadow-md hover:scale-105"),children:e},e))}),x&&(0,a.jsx)("div",{className:"text-center py-12",children:(0,a.jsx)("div",{className:"text-2xl text-pink-500",children:"กำลังโหลดคอร์ส..."})}),!x&&0===s.length&&(0,a.jsxs)("div",{className:"glass p-12 rounded-2xl text-center",children:[(0,a.jsx)(i.Mp$,{className:"text-6xl text-gray-400 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-600",children:"ไม่พบคอร์สที่ตรงกับการค้นหา"})]}),!x&&s.length>0&&(0,a.jsx)("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:s.map(e=>{var t,s;return(0,a.jsxs)(n.default,{href:"/courses/".concat(e.id),className:"glass p-6 rounded-2xl hover:shadow-2xl hover:scale-105 transition-all",children:[e.thumbnail?(0,a.jsx)("img",{src:e.thumbnail,alt:e.title,className:"w-full h-48 object-cover rounded-lg mb-4"}):(0,a.jsx)("div",{className:"w-full h-48 bg-gradient-to-br from-pink-300 to-pink-500 rounded-lg mb-4 flex items-center justify-center",children:(0,a.jsx)(i.Mp$,{className:"text-6xl text-white opacity-50"})}),(0,a.jsx)("h3",{className:"text-xl font-bold mb-2 line-clamp-2 text-gray-900",children:e.title}),(0,a.jsx)("p",{className:"text-gray-700 mb-3 line-clamp-2",children:e.description}),(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)(i.QJe,{className:"text-yellow-500"}),(0,a.jsx)("span",{className:"font-semibold",children:e.avgRating>0?e.avgRating.toFixed(1):"ยังไม่มีรีวิว"}),e.reviewCount>0&&(0,a.jsxs)("span",{className:"text-gray-600 text-sm",children:["(",e.reviewCount,")"]})]}),(0,a.jsxs)("span",{className:"text-sm text-gray-700",children:[(null===(t=e.lessons)||void 0===t?void 0:t.length)||0," บทเรียน"]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2 text-sm text-gray-700",children:[(0,a.jsx)(i.Xws,{}),(0,a.jsx)("span",{children:null===(s=e.instructor)||void 0===s?void 0:s.full_name})]}),(0,a.jsx)("div",{className:"text-lg font-bold text-pink-500",children:e.price>0?"฿".concat(e.price):"ฟรี"})]})]},e.id)})})]})]})}},4958:function(e,t,s){"use strict";s.r(t),s.d(t,{auth:function(){return r},db:function(){return n},storage:function(){return l},supabase:function(){return a}});let a=(0,s(7688).eI)("https://ctnmxbhrlqcboztdumgb.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImN0bm14YmhybHFjYm96dGR1bWdiIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzA3NTA0MzgsImV4cCI6MjA4NjMyNjQzOH0.CBikuMmopGp_wOQvlVNIQXuBQ-dQ7DysT05tpgA156E"),r={signUp:async function(e,t,s){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"student",{data:n,error:l}=await a.auth.signUp({email:e,password:t,options:{data:{full_name:s,role:r,password:t}}});return{data:n,error:l}},signIn:async(e,t)=>{let{data:s,error:r}=await a.auth.signInWithPassword({email:e,password:t});return{data:s,error:r}},signOut:async()=>{let{error:e}=await a.auth.signOut();return{error:e}},getSession:async()=>{let{data:{session:e},error:t}=await a.auth.getSession();return{session:e,error:t}},getUser:async()=>{let{data:{user:e},error:t}=await a.auth.getUser();return{user:e,error:t}}},n={getProfile:async e=>{let{data:t,error:s}=await a.from("profiles").select("*").eq("id",e).single();return{data:t,error:s}},updateProfile:async(e,t)=>{let{data:s,error:r}=await a.from("profiles").update(t).eq("id",e).select().single();return{data:s,error:r}},getCourses:async e=>{let t=a.from("courses").select("\n      *,\n      instructor:profiles!instructor_id(full_name, avatar_url),\n      lessons(id),\n      reviews(rating)\n    ");(null==e?void 0:e.published)!==void 0&&(t=t.eq("published",e.published)),(null==e?void 0:e.category)&&(t=t.eq("category",e.category)),(null==e?void 0:e.search)&&(t=t.ilike("title","%".concat(e.search,"%")));let{data:s,error:r}=await t.order("created_at",{ascending:!1});return{data:s,error:r}},getCourse:async e=>{let{data:t,error:s}=await a.from("courses").select("\n        *,\n        instructor:profiles!instructor_id(full_name, avatar_url, email),\n        lessons(*),\n        reviews(id, rating, comment, created_at, user:profiles(full_name, avatar_url))\n      ").eq("id",e).single();return{data:t,error:s}},createCourse:async e=>{let{data:t,error:s}=await a.from("courses").insert(e).select().single();return{data:t,error:s}},updateCourse:async(e,t)=>{let{data:s,error:r}=await a.from("courses").update({...t,updated_at:new Date().toISOString()}).eq("id",e).select().single();return{data:s,error:r}},deleteCourse:async e=>{let{error:t}=await a.from("courses").delete().eq("id",e);return{error:t}},createLesson:async e=>{let{data:t,error:s}=await a.from("lessons").insert(e).select().single();return{data:t,error:s}},updateLesson:async(e,t)=>{let{data:s,error:r}=await a.from("lessons").update(t).eq("id",e).select().single();return{data:s,error:r}},deleteLesson:async e=>{let{error:t}=await a.from("lessons").delete().eq("id",e);return{error:t}},getEnrollment:async(e,t)=>{let{data:s,error:r}=await a.from("enrollments").select("*").eq("user_id",e).eq("course_id",t).single();return{data:s,error:r}},getUserEnrollments:async e=>{let{data:t,error:s}=await a.from("enrollments").select("\n        *,\n        course:courses(*, instructor:profiles!instructor_id(full_name), lessons(id))\n      ").eq("user_id",e).order("enrolled_at",{ascending:!1});return{data:t,error:s}},createEnrollment:async(e,t)=>{let{data:s,error:r}=await a.from("enrollments").insert({user_id:e,course_id:t}).select().single();return{data:s,error:r}},updateProgress:async(e,t)=>{let{data:s,error:r}=await a.from("enrollments").update({progress:t}).eq("id",e).select().single();return{data:s,error:r}},createReview:async e=>{let{data:t,error:s}=await a.from("reviews").insert(e).select().single();return{data:t,error:s}},updateReview:async(e,t)=>{let{data:s,error:r}=await a.from("reviews").update({...t,updated_at:new Date().toISOString()}).eq("id",e).select().single();return{data:s,error:r}},getUserReview:async(e,t)=>{let{data:s,error:r}=await a.from("reviews").select("*").eq("user_id",e).eq("course_id",t).single();return{data:s,error:r}}},l={uploadAvatar:async(e,t)=>{let s=t.name.split(".").pop(),r="".concat(e,".").concat(s),{data:n,error:l}=await a.storage.from("avatars").upload(r,t,{upsert:!0});if(l)return{data:null,error:l};let{data:{publicUrl:i}}=a.storage.from("avatars").getPublicUrl(r);return{data:i,error:null}},uploadThumbnail:async(e,t)=>{let s=t.name.split(".").pop(),r="".concat(e,".").concat(s),{data:n,error:l}=await a.storage.from("thumbnails").upload(r,t,{upsert:!0});if(l)return{data:null,error:l};let{data:{publicUrl:i}}=a.storage.from("thumbnails").getPublicUrl(r);return{data:i,error:null}},uploadCourseFile:async(e,t)=>{let s=t.name.split(".").pop(),r="".concat(e,"/").concat(Date.now(),".").concat(s),{data:n,error:l}=await a.storage.from("course-files").upload(r,t);if(l)return{data:null,error:l};let{data:{publicUrl:i}}=a.storage.from("course-files").getPublicUrl(r);return{data:i,error:null}}}}},function(e){e.O(0,[699,250,126,971,69,744],function(){return e(e.s=655)}),_N_E=e.O()}]);